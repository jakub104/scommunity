(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36a82728"],{"0ba4":function(e,t,n){},"13d5":function(e,t,n){"use strict";var a=n("23e7"),r=n("d58f").left,s=n("a640"),i=n("ae40"),o=s("reduce"),c=i("reduce",{1:0});a({target:"Array",proto:!0,forced:!o||!c},{reduce:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"1dde":function(e,t,n){var a=n("d039"),r=n("b622"),s=n("2d00"),i=r("species");e.exports=function(e){return s>=51||!a((function(){var t=[],n=t.constructor={};return n[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"1e8f":function(e,t,n){},2532:function(e,t,n){"use strict";var a=n("23e7"),r=n("5a34"),s=n("1d80"),i=n("ab13");a({target:"String",proto:!0,forced:!i("includes")},{includes:function(e){return!!~String(s(this)).indexOf(r(e),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(e,t,n){var a=n("861d"),r=n("c6b6"),s=n("b622"),i=s("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==r(e))}},"498a":function(e,t,n){"use strict";var a=n("23e7"),r=n("58a8").trim,s=n("c8d2");a({target:"String",proto:!0,forced:s("trim")},{trim:function(){return r(this)}})},"4de4":function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").filter,s=n("1dde"),i=n("ae40"),o=s("filter"),c=i("filter");a({target:"Array",proto:!0,forced:!o||!c},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"4fad":function(e,t,n){var a=n("23e7"),r=n("6f53").entries;a({target:"Object",stat:!0},{entries:function(e){return r(e)}})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var a=n("1d80"),r=n("5899"),s="["+r+"]",i=RegExp("^"+s+s+"*"),o=RegExp(s+s+"*$"),c=function(e){return function(t){var n=String(a(t));return 1&e&&(n=n.replace(i,"")),2&e&&(n=n.replace(o,"")),n}};e.exports={start:c(1),end:c(2),trim:c(3)}},"5a34":function(e,t,n){var a=n("44e7");e.exports=function(e){if(a(e))throw TypeError("The method doesn't accept regular expressions");return e}},6994:function(e,t,n){"use strict";var a=n("9a8a"),r=n.n(a);r.a},"6f53":function(e,t,n){var a=n("83ab"),r=n("df75"),s=n("fc6a"),i=n("d1e7").f,o=function(e){return function(t){var n,o=s(t),c=r(o),u=c.length,l=0,d=[];while(u>l)n=c[l++],a&&!i.call(o,n)||d.push(e?[n,o[n]]:o[n]);return d}};e.exports={entries:o(!0),values:o(!1)}},7156:function(e,t,n){var a=n("861d"),r=n("d2bb");e.exports=function(e,t,n){var s,i;return r&&"function"==typeof(s=t.constructor)&&s!==n&&a(i=s.prototype)&&i!==n.prototype&&r(e,i),e}},"7c86":function(e,t,n){"use strict";var a=n("0ba4"),r=n.n(a);r.a},"7db0":function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").find,s=n("44d2"),i=n("ae40"),o="find",c=!0,u=i(o);o in[]&&Array(1)[o]((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!u},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},"8df8":function(e,t,n){"use strict";e.exports=s,e.exports.isMobile=s,e.exports.default=s;var a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function s(e){e||(e={});var t=e.ua;if(t||"undefined"===typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"===typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"!==typeof t)return!1;var n=e.tablet?r.test(t):a.test(t);return!n&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==t.indexOf("Macintosh")&&-1!==t.indexOf("Safari")&&(n=!0),n}},"9a8a":function(e,t,n){},a9e3:function(e,t,n){"use strict";var a=n("83ab"),r=n("da84"),s=n("94ca"),i=n("6eeb"),o=n("5135"),c=n("c6b6"),u=n("7156"),l=n("c04e"),d=n("d039"),f=n("7c73"),p=n("241c").f,g=n("06cf").f,h=n("9bf2").f,m=n("58a8").trim,v="Number",_=r[v],b=_.prototype,w=c(f(b))==v,y=function(e){var t,n,a,r,s,i,o,c,u=l(e,!1);if("string"==typeof u&&u.length>2)if(u=m(u),t=u.charCodeAt(0),43===t||45===t){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+u}for(s=u.slice(2),i=s.length,o=0;o<i;o++)if(c=s.charCodeAt(o),c<48||c>r)return NaN;return parseInt(s,a)}return+u};if(s(v,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var C,k=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof k&&(w?d((function(){b.valueOf.call(n)})):c(n)!=v)?u(new _(y(t)),n,k):y(t)},x=a?p(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),$=0;x.length>$;$++)o(_,C=x[$])&&!o(k,C)&&h(k,C,g(_,C));k.prototype=b,b.constructor=k,i(r,v,k)}},ab13:function(e,t,n){var a=n("b622"),r=a("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(a){}}return!1}},b012:function(e,t){function n(e,t,n){var a,r,s,i,o;function c(){var u=Date.now()-i;u<t&&u>=0?a=setTimeout(c,t-u):(a=null,n||(o=e.apply(s,r),s=r=null))}null==t&&(t=100);var u=function(){s=this,r=arguments,i=Date.now();var u=n&&!a;return a||(a=setTimeout(c,t)),u&&(o=e.apply(s,r),s=r=null),o};return u.clear=function(){a&&(clearTimeout(a),a=null)},u.flush=function(){a&&(o=e.apply(s,r),s=r=null,clearTimeout(a),a=null)},u}n.debounce=n,e.exports=n},c740:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").findIndex,s=n("44d2"),i=n("ae40"),o="findIndex",c=!0,u=i(o);o in[]&&Array(1)[o]((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!u},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},c8d2:function(e,t,n){var a=n("d039"),r=n("5899"),s="​᠎";e.exports=function(e){return a((function(){return!!r[e]()||s[e]()!=s||r[e].name!==e}))}},caad:function(e,t,n){"use strict";var a=n("23e7"),r=n("4d64").includes,s=n("44d2"),i=n("ae40"),o=i("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:!o},{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),s("includes")},d58f:function(e,t,n){var a=n("1c0b"),r=n("7b0b"),s=n("44ad"),i=n("50c4"),o=function(e){return function(t,n,o,c){a(n);var u=r(t),l=s(u),d=i(u.length),f=e?d-1:0,p=e?-1:1;if(o<2)while(1){if(f in l){c=l[f],f+=p;break}if(f+=p,e?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;e?f>=0:d>f;f+=p)f in l&&(c=n(c,l[f],f,u));return c}};e.exports={left:o(!1),right:o(!0)}},d81d:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").map,s=n("1dde"),i=n("ae40"),o=s("map"),c=i("map");a({target:"Array",proto:!0,forced:!o||!c},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},ec44:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"private-chat-wrapper"},[n("ChatsPreview",{attrs:{chats:e.chats}}),n("MainChat",{attrs:{chat:e.chat,messages:e.messages,newMessages:e.newMessages,replyTo:e.replyTo,writers:e.writers},on:{"send-message":e.sendMessage,reply:e.reply,"undo-reply":e.undoReply}})],1)},r=[],s=(n("4de4"),n("caad"),n("d81d"),n("13d5"),n("a9e3"),n("4fad"),n("2532"),n("498a"),n("96cf"),n("1da1")),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["chats-preview-wrapper",{"chats-preview-wrapper--collapse":e.collapse}]},[n("div",{staticClass:"wrapper-expand",on:{click:function(t){e.collapse=!e.collapse}}},[e.collapse?n("fa-icon",{staticClass:"expand__icon",attrs:{icon:"angle-right"}}):n("fa-icon",{staticClass:"expand__icon",attrs:{icon:"angle-left"}})],1),e.chats.length>0?n("div",{staticClass:"chats-preview"},e._l(e.chats,(function(t){return n("router-link",{key:t._id,class:["chat",{"chat--active":e.$route.params.id===t._id}],attrs:{to:{name:"Chat",params:{id:t._id}}}},[n("img",{staticClass:"chat__img",attrs:{src:t.img||e.getChat(t.owners).avatar,alt:e.getChat(t.owners).nick}}),n("div",{staticClass:"chat__info"},[n("h2",{staticClass:"info__name"},[e._v(e._s(t.name||e.getChat(t.owners).nick))]),t.lastMessage?n("div",{staticClass:"info__message"},[t.lastMessage.sender===e.$ls.get("id")?n("span",[e._v("Ty: ")]):e._e(),e._v(e._s(t.lastMessage.content)+" "),n("div",{staticClass:"message__date"},[e._v(e._s(e.$dayjs(t.lastMessage.createdAt).fromNow()))])]):n("div",{staticClass:"info__message"},[e._v(" . "),n("div",{staticClass:"message__date"},[e._v(e._s(e.$dayjs(t.createdAt).fromNow()))])])])])})),1):n("div",{staticClass:"chats-loader"},[e._v(" ... ")])])},o=[],c=(n("7db0"),{name:"ChatsPreview",props:{chats:Array},data:function(){return{collapse:!1}},watch:{$route:function(){window.innerWidth<=600&&(this.collapse=!0)}},methods:{getChat:function(e){var t=this,n=e.find((function(e){return e._id!==t.$ls.get("id")}));return n.info}}}),u=c,l=(n("7c86"),n("2877")),d=Object(l["a"])(u,i,o,!1,null,"02b48436",null),f=d.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.chat.owners?n("div",{staticClass:"main-chat-wrapper"},[e.chat.name&&e.chat.img?n("div",{staticClass:"chat__title"},[n("img",{staticClass:"title__img",attrs:{src:e.chat.img}}),n("h1",{staticClass:"title__name"},[e._v(e._s(e.chat.name))])]):n("div",{staticClass:"chat__title"},[n("img",{staticClass:"title__img",attrs:{src:e.getFriendInfo().avatar}}),n("h1",{staticClass:"title__name"},[e._v(e._s(e.getFriendInfo().nick))])]),n("div",{staticClass:"messages"},[e.messages.length>0||e.newMessages.length>0?n("fragment",[e.newMessages.length>0?n("div",{staticClass:"messages__group"},[e._l(e.newMessages,(function(t){return n("div",{key:t._id,class:["message",{"message--owner":t.sender===e.$ls.get("id")}],on:{dblclick:function(n){return e.$emit("reply",t.sender)}}},[t.sender!==e.$ls.get("id")?n("img",{staticClass:"message__sender",attrs:{src:e.getUserInfo(t.sender).avatar,alt:e.getUserInfo(t.sender).nick}}):e._e(),n("div",{staticClass:"message__content"},[e._v(e._s(t.content))]),n("div",{staticClass:"message__time"},[e._v(e._s(e.$dayjs(t.createdAt).format("H:mm")))])])})),n("div",{staticClass:"group__title"},[e._v("Teraz")])],2):e._e(),e._l(e.messages,(function(t){return n("div",{key:t[0],staticClass:"messages__group"},[e._l(t[1],(function(t){return n("div",{key:t._id,class:["message",{"message--owner":t.sender===e.$ls.get("id")}],on:{dblclick:function(n){return e.$emit("reply",t.sender)}}},[t.sender!==e.$ls.get("id")?n("img",{staticClass:"message__sender",attrs:{src:e.getUserInfo(t.sender).avatar,alt:e.getUserInfo(t.sender).nick}}):e._e(),n("div",{staticClass:"message__content"},[e._v(e._s(t.content))]),n("div",{staticClass:"message__time"},[e._v(e._s(e.$dayjs(t.createdAt).format("H:mm")))])])})),n("div",{staticClass:"group__title"},[e._v(e._s(t[0]))])],2)}))],2):n("fragment",[n("div",{staticClass:"messages__group"},[n("div",{staticClass:"group__title"},[e._v(" Brak wiadomości ")])])])],1),e.writers.length>0?n("div",{staticClass:"writers"},[e._l(e.writers,(function(e){return n("img",{key:e.nick,staticClass:"writer",attrs:{src:e.avatar}})})),e._m(0)],2):e._e(),e.replyTo?n("div",{staticClass:"reply"},[n("div",{staticClass:"reply__user"},[n("fa-icon",{attrs:{icon:"reply"}}),e._v(" "+e._s(e.getUserInfo(e.replyTo).nick)+" ")],1),n("div",{staticClass:"reply__undo",on:{click:function(t){return e.$emit("undo-reply")}}},[n("fa-icon",{attrs:{icon:"times"}})],1)]):e._e(),n("form",{staticClass:"answer",on:{submit:function(t){return t.preventDefault(),e.$emit("send-message")}}},[n("button",{staticClass:"answer__button",attrs:{type:"submit"}},[n("fa-icon",{attrs:{icon:"paper-plane"}})],1),n("span",{staticClass:"answer__input",attrs:{role:"textbox",id:"answer__input","data-placeholder":"Napisz coś...",contenteditable:""},on:{paste:e.clearHtml,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkKey(t)},input:function(t){e.$socket.emit("writing",e.getUserInfo(e.$ls.get("id")))}}}),n("button",{staticClass:"answer__button",attrs:{type:"submit"}},[n("fa-icon",{attrs:{icon:"sticky-note"}})],1),n("button",{staticClass:"answer__button",attrs:{type:"submit"}},[n("fa-icon",{attrs:{icon:"image"}})],1)])]):e._e()},g=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dotts"},[n("div",{staticClass:"dott"}),n("div",{staticClass:"dott"}),n("div",{staticClass:"dott"})])}],h=(n("c740"),n("8df8")),m=n.n(h),v={name:"MainChat",props:{chat:Object,messages:Array,newMessages:Array,replyTo:String,writers:Array},methods:{getUserInfo:function(e){var t=this.chat.owners.findIndex((function(t){return t._id===e}));return this.chat.owners[t].info},getFriendInfo:function(){var e=this;return this.chat.owners.filter((function(t){return t._id!==e.$ls.get("id")}))[0].info},clearHtml:function(e){e.preventDefault();var t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)},checkKey:function(e){e.shiftKey||m()()||(this.$emit("send-message"),e.preventDefault())}}},_=v,b=(n("fdb0"),Object(l["a"])(_,p,g,!1,null,"580c9f81",null)),w=b.exports,y=n("b012"),C=n.n(y),k={name:"PrivateChat",components:{ChatsPreview:f,MainChat:w},data:function(){return{chats:[],chat:{},messages:[],newMessages:[],replyTo:"",skip:0,writers:[]}},destroyed:function(){this.$socket.off("message")},created:function(){var e=this;this.$socket.on("message",(function(t,n){n===e.chat._id&&(console.log("Send: ",t,n),e.newMessages.unshift(t.message))})),this.$socket.on("writing",(function(t){e.addWriter(t)}))},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.get("/chats/user/me");case 3:n=t.sent,a=function(e,t){var n=Number(new Date(e.lastMessage?e.lastMessage.createdAt:e.createdAt)),a=Number(new Date(t.lastMessage?t.lastMessage.createdAt:t.createdAt));return console.log(n,a),n<a?1:n>a?-1:0},r=n.data.chats,console.log(r),e.chats=r.sort(a),e.loadChat(),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0.response.data);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},watch:{$route:function(){this.chat={},this.newMessages=[],this.loadChat()}},methods:{loadChat:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/chats/".concat(e.$route.params.id));case 2:n=t.sent,e.chat=n.data.chat,a=n.data.messages.reduce((function(t,n){var a=e.$dayjs(n.createdAt).get("year")===e.$dayjs().get("year")?e.$dayjs(n.createdAt).format("D MMMM"):e.$dayjs(n.createdAt).format("D MMMM YYYY");return(t[a]=t[a]||[]).push(n),t}),{}),e.messages=Object.entries(a);case 6:case"end":return t.stop()}}),t)})))()},sendMessage:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=document.getElementById("answer__input"),a=n.innerText.trim(),!a){t.next=14;break}return t.prev=3,n.innerHTML="",t.next=7,e.$axios.patch("/chats/".concat(e.chat._id,"/message/add"),{content:a,sender:e.$ls.get("id")});case 7:r=t.sent,e.$socket.emit("message",r.data,e.chat._id),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](3),console.log(t.t0.response.data);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})))()},reply:function(e){this.replyTo=e},undoReply:function(){this.replyTo=""},addWriter:function(e){this.writers.map((function(e){return e.nick})).includes(e.nick)||this.writers.push(e),this.removeWriter(e.nick)},removeWriter:C()((function(e){this.writers=this.writers.filter((function(t){return t.nick!==e}))}),1e3)}},x=k,$=(n("6994"),Object(l["a"])(x,a,r,!1,null,"795417be",null));t["default"]=$.exports},fdb0:function(e,t,n){"use strict";var a=n("1e8f"),r=n.n(a);r.a}}]);
//# sourceMappingURL=chunk-36a82728.001f2e92.js.map